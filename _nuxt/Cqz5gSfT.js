import{ar as G,S,as as Z,at as p,au as J,E as B,av as Q,aw as X,ax as h,ay as ee,az as te,H as oe,t as i,s as ie}from"./Bufd6AOs.js";class ne{constructor(e,o,n){this.from=e,this.to=o,this.diagnostic=n}}class u{constructor(e,o,n){this.diagnostics=e,this.panel=o,this.selected=n}static init(e,o,n){let a=e,s=n.facet(C).markerFilter;s&&(a=s(a,n));let l=p.set(a.map(r=>r.from==r.to||r.from==r.to-1&&n.doc.lineAt(r.from).to==r.from?p.widget({widget:new me(r),diagnostic:r}).range(r.from):p.mark({attributes:{class:"cm-lintRange cm-lintRange-"+r.severity+(r.markClass?" "+r.markClass:"")},diagnostic:r}).range(r.from,r.to)),!0);return new u(l,o,x(l))}}function x(t,e=null,o=0){let n=null;return t.between(o,1e9,(a,s,{spec:l})=>{if(!(e&&l.diagnostic!=e))return n=new ne(a,s,l.diagnostic),!1}),n}function ae(t,e){let o=e.pos,n=e.end||o,a=t.state.facet(C).hideOn(t,o,n);if(a!=null)return a;let s=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(l=>l.is(z))||t.changes.touchesRange(s.from,Math.max(s.to,n)))}function se(t,e){return t.field(m,!1)?e:e.concat(S.appendConfig.of(ue))}const z=S.define(),T=S.define(),_=S.define(),m=Z.define({create(){return new u(p.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let o=t.diagnostics.map(e.changes),n=null,a=t.panel;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);n=x(o,t.selected.diagnostic,s)||x(o,null,s)}!o.size&&a&&e.state.facet(C).autoPanel&&(a=null),t=new u(o,a,n)}for(let o of e.effects)if(o.is(z)){let n=e.state.facet(C).autoPanel?o.value.length?w.open:null:t.panel;t=u.init(o.value,n,e.state)}else o.is(T)?t=new u(t.diagnostics,o.value?w.open:null,t.selected):o.is(_)&&(t=new u(t.diagnostics,t.panel,o.value));return t},provide:t=>[J.from(t,e=>e.panel),B.decorations.from(t,e=>e.diagnostics)]}),re=p.mark({class:"cm-lintRange cm-lintRange-active"});function le(t,e,o){let{diagnostics:n}=t.state.field(m),a=[],s=2e8,l=0;n.between(e-(o<0?1:0),e+(o>0?1:0),(d,g,{spec:c})=>{e>=d&&e<=g&&(d==g||(e>d||o>0)&&(e<g||o<0))&&(a.push(c.diagnostic),s=Math.min(d,s),l=Math.max(g,l))});let r=t.state.facet(C).tooltipFilter;return r&&(a=r(a,t.state)),a.length?{pos:s,end:l,above:t.state.doc.lineAt(s).to<l,create(){return{dom:ce(t,a)}}}:null}function ce(t,e){return h("ul",{class:"cm-tooltip-lint"},e.map(o=>U(t,o,!1)))}const de=t=>{let e=t.state.field(m,!1);(!e||!e.panel)&&t.dispatch({effects:se(t.state,[T.of(!0)])});let o=G(t,w.open);return o&&o.dom.querySelector(".cm-panel-lint ul").focus(),!0},N=t=>{let e=t.state.field(m,!1);return!e||!e.panel?!1:(t.dispatch({effects:T.of(!1)}),!0)},ge=t=>{let e=t.state.field(m,!1);if(!e)return!1;let o=t.state.selection.main,n=e.diagnostics.iter(o.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==o.from&&n.to==o.to)?!1:(t.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},Se=[{key:"Mod-Shift-m",run:de,preventDefault:!0},{key:"F8",run:ge}],C=Q.define({combine(t){return Object.assign({sources:t.map(e=>e.source).filter(e=>e!=null)},X(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,o)=>e?o?n=>e(n)||o(n):e:o}))}});function K(t){let e=[];if(t)e:for(let{name:o}of t){for(let n=0;n<o.length;n++){let a=o[n];if(/[a-zA-Z]/.test(a)&&!e.some(s=>s.toLowerCase()==a.toLowerCase())){e.push(a);continue e}}e.push("")}return e}function U(t,e,o){var n;let a=o?K(e.actions):[];return h("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},h("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(n=e.actions)===null||n===void 0?void 0:n.map((s,l)=>{let r=!1,d=Y=>{if(Y.preventDefault(),r)return;r=!0;let P=x(t.state.field(m).diagnostics,e);P&&s.apply(t,P.from,P.to)},{name:g}=s,c=a[l]?g.indexOf(a[l]):-1,b=c<0?g:[g.slice(0,c),h("u",g.slice(c,c+1)),g.slice(c+1)];return h("button",{type:"button",class:"cm-diagnosticAction",onclick:d,onmousedown:d,"aria-label":` Action: ${g}${c<0?"":` (access key "${a[l]})"`}.`},b)}),e.source&&h("div",{class:"cm-diagnosticSource"},e.source))}class me extends te{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return h("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class F{constructor(e,o){this.diagnostic=o,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=U(e,o,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class w{constructor(e){this.view=e,this.items=[];let o=a=>{if(a.keyCode==27)N(this.view),this.view.focus();else if(a.keyCode==38||a.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(a.keyCode==40||a.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(a.keyCode==36)this.moveSelection(0);else if(a.keyCode==35)this.moveSelection(this.items.length-1);else if(a.keyCode==13)this.view.focus();else if(a.keyCode>=65&&a.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],l=K(s.actions);for(let r=0;r<l.length;r++)if(l[r].toUpperCase().charCodeAt(0)==a.keyCode){let d=x(this.view.state.field(m).diagnostics,s);d&&s.actions[r].apply(e,d.from,d.to)}}else return;a.preventDefault()},n=a=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(a.target)&&this.moveSelection(s)};this.list=h("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:o,onclick:n}),this.dom=h("div",{class:"cm-panel-lint"},this.list,h("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>N(this.view)},"Ã—")),this.update()}get selectedIndex(){let e=this.view.state.field(m).selected;if(!e)return-1;for(let o=0;o<this.items.length;o++)if(this.items[o].diagnostic==e.diagnostic)return o;return-1}update(){let{diagnostics:e,selected:o}=this.view.state.field(m),n=0,a=!1,s=null;for(e.between(0,this.view.state.doc.length,(l,r,{spec:d})=>{let g=-1,c;for(let b=n;b<this.items.length;b++)if(this.items[b].diagnostic==d.diagnostic){g=b;break}g<0?(c=new F(this.view,d.diagnostic),this.items.splice(n,0,c),a=!0):(c=this.items[g],g>n&&(this.items.splice(n,g-n),a=!0)),o&&c.diagnostic==o.diagnostic?c.dom.hasAttribute("aria-selected")||(c.dom.setAttribute("aria-selected","true"),s=c):c.dom.hasAttribute("aria-selected")&&c.dom.removeAttribute("aria-selected"),n++});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)a=!0,this.items.pop();this.items.length==0&&(this.items.push(new F(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),a=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:l,panel:r})=>{let d=r.height/this.list.offsetHeight;l.top<r.top?this.list.scrollTop-=(r.top-l.top)/d:l.bottom>r.bottom&&(this.list.scrollTop+=(l.bottom-r.bottom)/d)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),a&&this.sync()}sync(){let e=this.list.firstChild;function o(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)o();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)o()}moveSelection(e){if(this.selectedIndex<0)return;let o=this.view.state.field(m),n=x(o.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:_.of(n)})}static open(e){return new w(e)}}function fe(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function y(t){return fe(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const he=B.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:y("#d11")},".cm-lintRange-warning":{backgroundImage:y("orange")},".cm-lintRange-info":{backgroundImage:y("#999")},".cm-lintRange-hint":{backgroundImage:y("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),ue=[m,B.decorations.compute([m],t=>{let{selected:e,panel:o}=t.field(m);return!e||!o||e.from==e.to?p.none:p.set([re.range(e.from,e.to)])}),ee(le,{hideOn:ae}),he],E="var(--md-base-color)",V="#3b4252",$="#434c5e",v="#4c566a",A="#e5e9f0",M="var(--md-cm-gutter-bg)",I="#8fbcbb",H="#88c0d0",pe="#81a1c1",f="#5e81ac",be="#bf616a",k="#d08770",R="#ebcb8b",W="#a3be8c",ke="#b48ead",O="#d30102",j=M,D=j,xe="var(--md-background-color)",L=A,Ce="var(--md-cm-selected-text-bg)",q=V,we=B.theme({"&":{color:E,backgroundColor:xe},".cm-content":{caretColor:q},".cm-cursor, .cm-dropCursor":{borderLeftColor:q},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Ce},".cm-panels":{backgroundColor:j,color:v},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:`1px solid ${v}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:A},".cm-activeLine":{backgroundColor:D},".cm-selectionMatch":{backgroundColor:A},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${v}`},"&.cm-focused .cm-matchingBracket":{backgroundColor:M},".cm-gutters":{backgroundColor:M,color:E,border:"none"},".cm-activeLineGutter":{backgroundColor:D},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:L},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:L,borderBottomColor:L},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:D,color:v}}},{dark:!0}),ye=oe.define([{tag:i.keyword,color:f},{tag:[i.name,i.deleted,i.character,i.propertyName,i.macroName],color:k},{tag:[i.variableName],color:k},{tag:[i.function(i.variableName)],color:f},{tag:[i.labelName],color:pe},{tag:[i.color,i.constant(i.name),i.standard(i.name)],color:f},{tag:[i.definition(i.name),i.separator],color:W},{tag:[i.brace],color:I},{tag:[i.annotation],color:O},{tag:[i.number,i.changed,i.annotation,i.modifier,i.self,i.namespace],color:H},{tag:[i.typeName,i.className],color:R},{tag:[i.operator,i.operatorKeyword],color:W},{tag:[i.tagName],color:ke},{tag:[i.squareBracket],color:be},{tag:[i.angleBracket],color:k},{tag:[i.attributeName],color:R},{tag:[i.regexp],color:f},{tag:[i.quote],color:V},{tag:[i.string],color:k},{tag:i.link,color:I,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[i.url,i.escape,i.special(i.string)],color:k},{tag:[i.meta],color:H},{tag:[i.comment],color:$,fontStyle:"italic"},{tag:i.strong,fontWeight:"bold",color:f},{tag:i.emphasis,fontStyle:"italic",color:f},{tag:i.strikethrough,textDecoration:"line-through"},{tag:i.heading,fontWeight:"bold",color:f},{tag:i.special(i.heading1),fontWeight:"bold",color:f},{tag:i.heading1,fontWeight:"bold",color:f},{tag:[i.heading2,i.heading3,i.heading4],fontWeight:"bold",color:f},{tag:[i.heading5,i.heading6],color:f},{tag:[i.atom,i.bool,i.special(i.variableName)],color:k},{tag:[i.processingInstruction,i.inserted],color:I},{tag:[i.contentSeparator],color:R},{tag:i.invalid,color:$,borderBottom:`1px dotted ${O}`}]);ie(ye);export{ye as a,we as b,Se as l};
