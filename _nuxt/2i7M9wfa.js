import{_ as T}from"./D9YvbS0Q.js";import B from"./CoK3geHk.js";import L from"./Do1YLDbQ.js";import{_ as O}from"./B0xMvvnt.js";import U from"./Dfcuivr0.js";import{g as E,r as m,h as R,i as _,j as M,c as p,b as u,a as o,t as v,f as n,w as x,F as V,k as A,l as I,m as P,o as h}from"./BywbvUV4.js";import{b as Q,m as S,a as G}from"./CS_T3frf.js";import{M as f}from"./DshPJGOp.js";import{q as D}from"./BPIDwa4h.js";import"./DJ0DXnYI.js";import"./0FfkP5H0.js";import"./Xg4DtNES.js";import"./Bwnz2dT-.js";import"./CEoXMRbW.js";import"./BN81KFzR.js";import"./6bm_RRcn.js";import"./DnsueCtQ.js";const H={class:"container"},Y={class:"main-container"},j={class:"content-container"},J={class:"article-title"},z={class:"article-meta-container"},K={class:"article-meta"},W={class:"article-meta"},X={class:"article-meta",style:{"margin-left":"0.3rem"}},Z={class:"article-meta"},ee=o("span",{class:"article-edit"},"Edit",-1),te=["innerHTML"],ae={class:"siderbar-container"},oe={key:0},ne=["href"],$e={__name:"[...slug]",async setup(se){let e,s;const b=E(),t=m(),y=m(""),d=m(""),$=G,l=Q(R().public.mindpress),C=b.query,k=b.params.slug,r=(l.mode===f.SSG||l.mode===f.FCM)&&k[0]==="undefined"?m(null):m(k[0]);if(!r.value&&C.id&&(r.value=C.id),console.log("mode===>"+l.mode),l.mode===f.SSG){y.value="No content found.";const i="/article/"+r.value;console.log(i);const a=r.value.indexOf(":")>=0?([e,s]=_(()=>D().where({_id:{$eq:r.value}}).findOne()),e=await e,s(),e):([e,s]=_(()=>D().where({permalink:{$eq:i}}).findOne()),e=await e,s(),e);console.log(a),t.value=a,t.value.time=a.date,t.value.author=S(a),t.value.articleid=r.value,d.value=a.body.toc}else if(l.mode==f.FCM)try{const{data:i}=([e,s]=_(()=>M("/api/md/query?_id="+r.value,"$1QhhxcnDTY")),e=await e,s(),e);console.log("***************");const a=i.value;console.log(a),t.value=a,t.value.time=a.date,t.value.author=S(a),t.value.articleid=r.value,d.value=a.body.toc}catch(i){console.warn(i)}else{console.log("server mode.");const i=l.contentUrl+"/"+r.value,{data:a}=([e,s]=_(()=>M(i,"$3maICFseYQ")),e=await e,s(),e),g=m(a.value.content),{data:c,refresh:q}=([e,s]=_(async()=>P(r.value,async()=>{try{return await $fetch("/api/parse",{method:"POST",cors:!0,body:{id:"content:_file.md",content:g.value}})}catch{return c.value}},"$aBbtUaneJv")),e=await e,s(),e);c.value.success||(y.value='Markdown parser error: <span style="color:red">'+c.value.msg+"</span>. Program language does not support."),t.value=c.value.data,t.value.title=a.value.title,t.value.author=a.value.createBy,t.value.time=a.value.createTime,t.value.articleid=a.value.articleid,t.value.editable=a.value.editable}return(i,a)=>{const g=T,c=B,q=L,F=O,N=U;return h(),p("div",null,[u(g),o("main",H,[o("div",Y,[o("div",j,[o("div",J,v(n(t).title),1),o("div",z,[o("span",K,[u(c,{name:"i-heroicons-calendar-days"})]),u(q,{text:"Update time: "+n($)(n(t).time,"en"),popper:{arrow:!0}},{default:x(()=>[o("span",W,v(n($)(n(t).createTime,"en")),1)]),_:1},8,["text"]),o("span",X,v(n(t).author),1),o("span",Z,[u(F,{to:"/edit?id="+n(t).articleid},{default:x(()=>[u(c,{name:"i-heroicons-pencil-square"}),ee]),_:1},8,["to"])])]),u(N,{value:n(t)},{empty:x(()=>[o("label",{style:{"margin-bottom":"1rem"},innerHTML:n(y)},null,8,te)]),_:1},8,["value"])]),o("div",ae,[n(d)&&n(d).links?(h(),p("ul",oe,[(h(!0),p(V,null,A(n(d).links,w=>(h(),p("li",{key:w.text},[o("a",{href:`#${w.id}`},v(w.text),9,ne)]))),128))])):I("",!0)])])])])}}};export{$e as default};
