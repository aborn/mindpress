import{_ as R}from"./Cgerfk6U.js";import{_ as b}from"./JE7RZuBo.js";import x from"./rsv2OuEX.js";import{b as U,c as P,d as k}from"./DtlU0Yam.js";import{r as c,h as B,O as E,B as H,P as Y,i as f,j as N,c as p,b as g,a as C,F,k as T,d as $,l as A,m as D,o as v}from"./D6ngAd8t.js";import{u as O}from"./Dwcg0_5Q.js";import{M as u}from"./DshPJGOp.js";import{q as V}from"./BjbDE7hK.js";import{q as G}from"./3EvPgMXE.js";import"./DqZmW5Rw.js";import"./BxO54sxf.js";import"./BpZh8ZVW.js";import"./Dd-DcO-u.js";import"./BvwqRU9-.js";import"./DcdWqMh8.js";const I={class:"container"},z={class:"articles"},j={key:0,href:"#"},ue={__name:"index",async setup(Q){let t,n;const r=c([]),l=U(B().public.mindpress),_=O(),{$settings:q}=E();console.log("settttttttts--->"),console.log(q);const M=_.protocol+"//"+_.host;console.log(l),console.log(M),console.log("mode===>"+l.mode);const a=c(1),i=c(!1),m=c(!1);H(()=>{{window.addEventListener("scroll",w);let e=document.body.scrollHeight,o=window.scrollY+window.innerHeight;console.log("d:"+e+", s:"+o),e<o&&h()}}),Y(()=>{window.removeEventListener("scroll",w)});const d=c(!1);function h(){if(!i.value&&!m.value){i.value=!0;try{if(l.mode==u.SSG)return;console.log("pageNo=="+a.value);const e=l.mode==u.FCM?"/api/md/query":l.mode==u.SCM?l.metaUrl:null;V({pageNo:a.value,url:e}).then(o=>{i.value=!1,a.value>=o.totalPage?m.value=!0:a.value=a.value+1,r.value.push(...o.data)},o=>{i.value=!1,console.error(o)})}catch(e){console.warn(e),i.value=!1}}m.value&&(d.value=!1)}function w(e){{var o=window.scrollY;o<this.scrollPosition?console.log("Scrolling up"):console.log("Scrolling down");let s=document.body.scrollHeight;window.scrollY+window.innerHeight+200>s?(console.log("You are at the bottom! isLoading="+i.value+", is isLastPage="+m.value),d.value=!0,h()):d.value=!1,this.scrollPosition=window.scrollY}}if(l.mode===u.SSG){if(r.value.length<=0){const{data:e}=([t,n]=f(()=>D("home",()=>G().sort({_id:1}).find())),t=await t,n(),t);console.log("--------data SSG-----"),console.log(e.value);const o=e.value.map(s=>P(s));r.value=o}}else if(l.mode===u.FCM)try{const{data:e}=([t,n]=f(()=>N("/api/md/query",{method:"POST",body:{pageNo:a.value,pageSize:9,sort:{createTime:-1,title:1}}},"$PslAyef5YX")),t=await t,n(),t);a.value=a.value+1,console.log(e.value.data);const o=e.value.data.map(s=>P(s));r.value=o,console.log("***************")}catch(e){console.warn(e)}else{const{data:e}=([t,n]=f(()=>N(l.metaUrl,"$6PO73qLRkI")),t=await t,n(),t);if(a.value=a.value+1,e.value.totalElements>0){const o=c([]);o.value=e.value.content.map(s=>k(s)),r.value=o.value}}return(e,o)=>{const s=R,S=b,y=x;return v(),p("div",null,[g(s),C("main",I,[C("div",z,[(v(!0),p(F,null,T(r.value,L=>(v(),p("div",{class:"article",key:L.id},[g(S,{item:L},null,8,["item"])]))),128))]),d.value?(v(),p("a",j,[$("Loading "),g(y,{name:"i-heroicons-ellipsis-horizontal-16-solid"})])):A("",!0)])])}}};export{ue as default};
