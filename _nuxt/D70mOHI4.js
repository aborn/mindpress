import{_ as R}from"./DHkkyGU5.js";import{_ as b}from"./CNljlJyC.js";import{_ as x}from"./Cl7s5NGN.js";import{b as E,c as N,d as H}from"./CvIXsaFB.js";import{q as c,D as U,a4 as Y,s as k,S as A,E as f,G as P,c as d,b as g,a as q,F as B,A as D,d as F,z as T,H as $,o as p}from"./CN9afWd_.js";import{u as V}from"./Dwcg0_5Q.js";import{M as v}from"./DshPJGOp.js";import{q as z}from"./DaQUaYyD.js";import{q as G}from"./MIL4fs-p.js";import"./CyaWhohe.js";import"./DhMMPS2l.js";import"./GnEriZLr.js";import"./CAZilBRX.js";import"./Do-JtEzW.js";const I={class:"container"},O={class:"articles"},Q={key:0,href:"#"},ce={__name:"index",async setup(X){let t,n;const r=c([]),l=E(U().public.mindpress),_=V(),{$settings:C}=Y();console.log("settttttttts--->"),console.log(C);const M=_.protocol+"//"+_.host;console.log(l),console.log(M),console.log("mode===>"+l.mode);const a=c(1),i=c(!1),u=c(!1);k(()=>{{window.addEventListener("scroll",w);let e=document.body.scrollHeight,o=window.scrollY+window.innerHeight;console.log("d:"+e+", s:"+o),e<o&&h()}}),A(()=>{window.removeEventListener("scroll",w)});const m=c(!1);function h(){if(!i.value&&!u.value){i.value=!0;try{console.log("pageNo=="+a.value);const e=l.mode==v.FCM?"/api/md/query":l.mode==v.SCM?l.metaUrl:null;z({pageNo:a.value,url:e}).then(o=>{i.value=!1,a.value>=o.totalPage?u.value=!0:a.value=a.value+1,r.value.push(...o.data)},o=>{i.value=!1,console.error(o)})}catch(e){console.warn(e),i.value=!1}}u.value&&(m.value=!1)}function w(e){{var o=window.scrollY;o<this.scrollPosition?console.log("Scrolling up"):console.log("Scrolling down");let s=document.body.scrollHeight;window.scrollY+window.innerHeight+200>s?(console.log("You are at the bottom! isLoading="+i.value+", is isLastPage="+u.value),m.value=!0,h()):m.value=!1,this.scrollPosition=window.scrollY}}if(l.mode===v.SSG){if(r.value.length<=0){const{data:e}=([t,n]=f(()=>$("home",()=>G().sort({_id:1}).find())),t=await t,n(),t);console.log("--------data SSG-----");const o=e.value.map(s=>N(s));r.value=o}}else if(l.mode===v.FCM)try{const{data:e}=([t,n]=f(()=>P("/api/md/query",{method:"POST",body:{pageNo:a.value,pageSize:9,sort:{createTime:-1,title:1}}},"$PslAyef5YX")),t=await t,n(),t);a.value=a.value+1;const o=e.value.data.map(s=>N(s));r.value=o}catch(e){console.warn(e)}else{const{data:e}=([t,n]=f(()=>P(l.metaUrl,"$6PO73qLRkI")),t=await t,n(),t);if(a.value=a.value+1,e.value.totalElements>0){const o=c([]);o.value=e.value.content.map(s=>H(s)),r.value=o.value}}return(e,o)=>{const s=R,S=b,y=x;return p(),d("div",null,[g(s),q("main",I,[q("div",O,[(p(!0),d(B,null,D(r.value,L=>(p(),d("div",{class:"article",key:L.id},[g(S,{item:L},null,8,["item"])]))),128))]),m.value?(p(),d("a",Q,[F("Loading "),g(y,{name:"i-heroicons-ellipsis-horizontal-16-solid"})])):T("",!0)])])}}};export{ce as default};
