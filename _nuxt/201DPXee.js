import{_ as V}from"./Cgerfk6U.js";import{_ as R,o as d,c as f,M as A,N as U,a as v,W as x,X as B,F as E,k as M,R as P,t as I,x as j,r as g,h as H,b as C,Y as K,f as _,Q as $,w as z,d as G,q as Q,l as T,j as W}from"./D6ngAd8t.js";import X from"./C6SBaOt5.js";import Y from"./BF1WQrI0.js";import{_ as J}from"./JE7RZuBo.js";import{s as L,c as Z}from"./BjbDE7hK.js";import{b as ee,c as te,d as oe}from"./DtlU0Yam.js";import{M as b}from"./DshPJGOp.js";import"./DqZmW5Rw.js";import"./rsv2OuEX.js";import"./BvwqRU9-.js";import"./DqBrWh9h.js";import"./CTZ2Hakn.js";import"./BpZh8ZVW.js";import"./Dd-DcO-u.js";import"./blSOxsGD.js";import"./BxO54sxf.js";const se={name:"SearchAutocomplete",props:{items:{type:Array,required:!1,default:()=>[]},isAsync:{type:Boolean,required:!1,default:!1}},data(){return{isOpen:!1,results:[],search:"",isLoading:!1,arrowCounter:-1}},watch:{items:function(a,n){a.length!==n.length&&(this.results=a,this.isLoading=!1)}},mounted(){document.addEventListener("click",this.handleClickOutside)},destroyed(){document.removeEventListener("click",this.handleClickOutside)},methods:{setResult(a){this.search=a,this.isOpen=!1},filterResults(){this.results=this.items.filter(a=>a.toLowerCase().indexOf(this.search.toLowerCase())>-1)},onChange(){this.$emit("input",this.search),this.isAsync?this.isLoading=!0:(this.filterResults(),this.isOpen=!0)},handleClickOutside(a){this.$el.contains(a.target)||(this.isOpen=!1,this.arrowCounter=-1)},onArrowDown(){this.arrowCounter<this.results.length&&(this.arrowCounter=this.arrowCounter+1)},onArrowUp(){this.arrowCounter>0&&(this.arrowCounter=this.arrowCounter-1)},onEnter(){console.log(" ---- selected ! "+this.results[this.arrowCounter]),console.log(" -- origin value:"+this.search);const a=this.results[this.arrowCounter];a&&(this.search=a),this.$emit("search",this.search),this.isOpen=!1,this.arrowCounter=-1}}},ne={class:"autocomplete"},re={id:"autocomplete-results",class:"autocomplete-results"},ae={key:0,class:"loading"},ie=["onClick"];function le(a,n,y,u,o,t){return d(),f("div",ne,[A(v("input",{type:"text",onInput:n[0]||(n[0]=(...e)=>t.onChange&&t.onChange(...e)),"onUpdate:modelValue":n[1]||(n[1]=e=>o.search=e),onKeydown:[n[2]||(n[2]=x((...e)=>t.onArrowDown&&t.onArrowDown(...e),["down"])),n[3]||(n[3]=x((...e)=>t.onArrowUp&&t.onArrowUp(...e),["up"])),n[4]||(n[4]=x((...e)=>t.onEnter&&t.onEnter(...e),["enter"]))],style:{"margin-bottom":"0px"}},null,544),[[U,o.search]]),A(v("ul",re,[o.isLoading?(d(),f("li",ae," Loading results... ")):(d(!0),f(E,{key:1},M(o.results,(e,w)=>(d(),f("li",{key:w,onClick:h=>t.setResult(e),class:P(["autocomplete-result",{"is-active":w===o.arrowCounter}])},I(e),11,ie))),128))],512),[[B,o.isOpen]])])}const ce=R(se,[["render",le]]),ue={class:"container"},me=["innerHTML"],de={class:"articles"},Me=j({__name:"index",setup(a){const n=g([]),y=g(1),u=g(""),o=g(""),t=g([]),e=g(!1),w=Z(),h=ee(H().public.mindpress);function O(s){console.log(s);const i=typeof s=="string"?s:s.target.value;u.value=i,w(()=>q(i),500)}function N(s){console.log("------ searchAction ---"),console.log(s),u.value=s,S(s)}function q(s){const i=s;if(o.value="",e.value=!1,console.log("----onchanged:"+i),!s||s.length==0||h.mode!==b.FCM)return;const l="/api/md/search",c=performance.now();L({pageNo:y.value,url:l,q:i,autoSuggest:!0}).then(r=>{if(console.log(r),r){(performance.now()-c).toFixed(2);const p=r.map(m=>m.suggestion);console.log(p),n.value=p}},r=>{console.warn(r)})}function S(s){const i=h.searchUrl+"?q="+s;if(console.log(i),h.mode===b.SSG)t.value=[],o.value="no markdown file find."+h.mode,e.value=!1;else if(h.mode===b.FCM)try{const l="/api/md/search";let c=performance.now();e.value=!0,L({pageNo:y.value,url:l,q:s}).then(r=>{if(r){t.value=r.map(m=>te(m));let p=(performance.now()-c).toFixed(2);o.value='find <span style="color:red">'+r.length+`</span> markdown files. Time cost: ${p} milliseconds.`}else o.value='find <span style="color:red">0</span> markdown files.';e.value=!1},r=>{e.value=!1})}catch(l){console.warn(l)}else W(i,{key:i+s},"$cedS7FE3FC").then(l=>{const c=l.data.value;console.log(c),c&&c.totalElements>0?(t.value=c.content.map(r=>oe(r)),o.value='find <span style="color:red">'+c.totalElements+"</span> markdown files.",console.log(t.value),console.log(o.value)):(t.value=[],o.value="no markdown file find.")},l=>{o.value="http request error. "+l,t.value=[]})}function D(){if(console.log("--now submit... q="+u.value),!u.value){t.value=[],o.value="";return}S(u.value)}function F(){console.log("--form submit, do nothing... q="+u.value)}return(s,i)=>{const l=V,c=ce,r=X,k=Y,p=J;return d(),f("div",null,[C(l),v("main",ue,[v("form",{onSubmit:K(F,["prevent"]),style:{display:"flex","justify-content":"center","margin-bottom":"0rem"}},[C(c,{items:_(n),onInput:O,modelValue:_(u),"onUpdate:modelValue":i[0]||(i[0]=m=>$(u)?u.value=m:null),onSearch:N},null,8,["items","modelValue"]),C(r,{onClick:D,icon:"i-heroicons-magnifying-glass-16-solid",style:{width:"10rem","margin-left":"10px",height:"3.0rem"},block:""},{default:z(()=>[G("Search")]),_:1})],32),v("label",{style:{"margin-bottom":"1rem","margin-top":"1rem"},innerHTML:_(o)},null,8,me),_(e)?(d(),Q(k,{key:0,animation:"carousel"})):T("",!0),v("div",de,[_(e)?T("",!0):(d(!0),f(E,{key:0},M(_(t),m=>(d(),f("div",{class:"article",key:m.id},[C(p,{item:m},null,8,["item"])]))),128))])])])}}});export{Me as default};
