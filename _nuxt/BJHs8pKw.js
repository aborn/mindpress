import{_ as N}from"./cTGMJFXf.js";import{_ as B}from"./BQJ3mUbP.js";import{_ as L}from"./CsCLsNfs.js";import T from"./DmjyB11H.js";import{g as O,r as u,h as E,i as d,c as p,b as _,a as o,t as v,f as r,w as q,F as R,j as V,k as A,o as h}from"./B5I_lrM_.js";import{b as I,m as F,a as P}from"./tRb40OuR.js";import{M as f}from"./DshPJGOp.js";import{q as M}from"./U7hFId9G.js";import{u as S}from"./PPgRZCpY.js";import{u as Q}from"./Cm5kZlTA.js";import"./BnSAYxrr.js";import"./BQkc-AXV.js";import"./CFOmNat8.js";import"./C-v3KzvZ.js";import"./Cs1xv8Tg.js";import"./DvDH6DOc.js";const U={class:"container"},G={class:"main-container"},H={class:"content-container"},Y={class:"article-title"},j={class:"article-meta-container"},J={class:"article-meta"},z={class:"article-meta"},K={class:"article-meta",style:{"margin-left":"0.3rem"}},W={class:"article-meta"},X=o("span",{class:"article-edit"},"Edit",-1),Z=["innerHTML"],ee={class:"siderbar-container"},te={key:0},ae=["href"],we={__name:"[...slug]",async setup(oe){let e,n;const b=O(),t=u(),y=u(""),m=u(""),D=P,l=I(E().public.minpress),x=b.query,C=b.params.slug,s=(l.mode===f.SSG||l.mode===f.FCM)&&C[0]==="undefined"?u(null):u(C[0]);if(!s.value&&x.id&&(s.value=x.id),console.log("mode===>"+l.mode),l.mode===f.SSG){y.value="No content found.";const i="/article/"+s.value;console.log(i);const a=s.value.indexOf(":")>=0?([e,n]=d(()=>M().where({_id:{$eq:s.value}}).findOne()),e=await e,n(),e):([e,n]=d(()=>M().where({permalink:{$eq:i}}).findOne()),e=await e,n(),e);console.log(a),t.value=a,t.value.time=a.date,t.value.author=F(a),t.value.articleid=s.value,m.value=a.body.toc}else if(l.mode==f.FCM)try{const{data:i}=([e,n]=d(()=>S("/api/md/query?_id="+s.value,"$1QhhxcnDTY")),e=await e,n(),e);console.log("***************");const a=i.value;console.log(a),t.value=a,t.value.time=a.date,t.value.author=F(a),t.value.articleid=s.value,m.value=a.body.toc}catch(i){console.warn(i)}else{console.log("server mode.");const i=l.contentUrl+"/"+s.value,{data:a}=([e,n]=d(()=>S(i,"$3maICFseYQ")),e=await e,n(),e),g=u(a.value.content),{data:c,refresh:k}=([e,n]=d(async()=>Q(s.value,async()=>{try{return await $fetch("/api/parse",{method:"POST",cors:!0,body:{id:"content:_file.md",content:g.value}})}catch{return c.value}},"$aBbtUaneJv")),e=await e,n(),e);c.value.success||(y.value='Markdown parser error: <span style="color:red">'+c.value.msg+"</span>. Program language does not support."),t.value=c.value.data,t.value.title=a.value.title,t.value.author=a.value.createBy,t.value.time=a.value.createTime,t.value.articleid=a.value.articleid,t.value.editable=a.value.editable}return(i,a)=>{const g=N,c=B,k=L,$=T;return h(),p("div",null,[_(g),o("main",U,[o("div",G,[o("div",H,[o("div",Y,v(r(t).title),1),o("div",j,[o("span",J,[_(c,{name:"i-heroicons-calendar-days"})]),o("span",z,v(r(D)(r(t).createTime,"en")),1),o("span",K,v(r(t).author),1),o("span",W,[_(k,{to:"/edit?id="+r(t).articleid},{default:q(()=>[_(c,{name:"i-heroicons-pencil-square"}),X]),_:1},8,["to"])])]),_($,{value:r(t)},{empty:q(()=>[o("label",{style:{"margin-bottom":"1rem"},innerHTML:r(y)},null,8,Z)]),_:1},8,["value"])]),o("div",ee,[r(m)&&r(m).links?(h(),p("ul",te,[(h(!0),p(R,null,V(r(m).links,w=>(h(),p("li",{key:w.text},[o("a",{href:`#${w.id}`},v(w.text),9,ae)]))),128))])):A("",!0)])])])])}}};export{we as default};
