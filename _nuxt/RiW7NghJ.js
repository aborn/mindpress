import{_ as B}from"./D9YvbS0Q.js";import D from"./CoK3geHk.js";import E from"./Do1YLDbQ.js";import{_ as L}from"./B0xMvvnt.js";import{x as N,g as O,r,h as F,B as I,i as m,j as U,m as j,o as R,c as V,b as p,a as n,t as h,f as u,w as M}from"./BywbvUV4.js";import{b as W,m as q,a as H}from"./CS_T3frf.js";import{M as v}from"./DshPJGOp.js";import{q as A}from"./BPIDwa4h.js";import{c as P}from"./CBNSl5vn.js";import{w as T,c as G,a as X}from"./Mrg7HcN6.js";import"./DJ0DXnYI.js";import"./0FfkP5H0.js";import"./Xg4DtNES.js";import"./Bwnz2dT-.js";import"./CEoXMRbW.js";import"./DnsueCtQ.js";import"./BosuxZz1.js";const Q={class:"container"},z={class:"main-container"},J={class:"content-container"},K={class:"article-title"},Y={class:"article-meta-container"},Z={class:"article-meta"},ee={class:"article-meta"},te={class:"article-meta",style:{"margin-left":"0.3rem"}},ae={class:"article-meta"},oe=n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"24",viewBox:"0 0 24 24"},[n("path",{fill:"currentColor",d:"M15.85 8.14c.39 0 .77.03 1.14.08C16.31 5.25 13.19 3 9.44 3c-4.25 0-7.7 2.88-7.7 6.43c0 2.05 1.15 3.86 2.94 5.04L3.67 16.5l2.76-1.19c.59.21 1.21.38 1.87.47c-.09-.39-.14-.79-.14-1.21c-.01-3.54 3.44-6.43 7.69-6.43M12 5.89a.96.96 0 1 1 0 1.92a.96.96 0 0 1 0-1.92M6.87 7.82a.96.96 0 1 1 0-1.92a.96.96 0 0 1 0 1.92"}),n("path",{fill:"currentColor",d:"M22.26 14.57c0-2.84-2.87-5.14-6.41-5.14s-6.41 2.3-6.41 5.14s2.87 5.14 6.41 5.14c.58 0 1.14-.08 1.67-.2L20.98 21l-1.2-2.4c1.5-.94 2.48-2.38 2.48-4.03m-8.34-.32a.96.96 0 1 1 .96-.96c.01.53-.43.96-.96.96m3.85 0a.96.96 0 1 1 0-1.92a.96.96 0 0 1 0 1.92"})],-1),ne=[oe],se=n("span",{class:"article-edit"},"Edit",-1),ie=["innerHTML"],ce=n("div",{id:"snackbar"},null,-1),qe=N({__name:"[...slug]",async setup(le){let e,c;const f=O(),t=r(),y=r(""),_=r(""),g=r(""),w=H,d=W(F().public.mindpress),b=f.query;let S=r("");const x=f.params.slug,i=(d.mode===v.SSG||d.mode===v.FCM)&&x[0]==="undefined"?r(null):r(x[0]);!i.value&&b.id&&(i.value=b.id),I(()=>{{let a=G.codeThemeOption[2].value,o=document.getElementById("hljs");if(o!=null)o.setAttribute("href",a);else{const s=document.createElement("link");s.setAttribute("type","text/css"),s.setAttribute("rel","stylesheet"),s.setAttribute("href",a),s.setAttribute("id","hljs"),document.head.appendChild(s)}}});function $(){X(_.value)}if(console.log("mode===>"+d.mode+",  articleid.value="+i.value),d.mode===v.SSG){y.value="No content found.";const a="/article/"+i.value;console.log(a);const o=i.value.indexOf(":")>=0?([e,c]=m(()=>A().where({_id:{$eq:i.value}}).findOne()),e=await e,c(),e):([e,c]=m(()=>A().where({permalink:{$eq:a}}).findOne()),e=await e,c(),e);console.log(o),t.value=o,t.value.time=o.date,t.value.author=q(o),t.value.articleid=i.value,g.value=o.body.toc;const s=P(o.body),l=T(s);_.value=l}else if(d.mode==v.FCM)try{const a=([e,c]=m(()=>$fetch("/api/md/queryContent?_id="+i.value)),e=await e,c(),e);console.log("***************  client api ---"),console.log(a),t.value=a,t.value.time=a.date,t.value.author=q(a),t.value.articleid=i.value,g.value=a.body&&a.body.toc,S.value=a._file;const o=a.mdcontent,s=T(o);_.value=s}catch(a){console.warn(a)}else{console.log("server mode.");const a=d.contentUrl+"/"+i.value,{data:o}=([e,c]=m(()=>U(a,"$qjI33vIWiV")),e=await e,c(),e),s=r(o.value.content),{data:l,refresh:C}=([e,c]=m(async()=>j(i.value,async()=>{try{return await $fetch("/api/parse",{method:"POST",cors:!0,body:{id:"content:_file.md",content:s.value}})}catch{return l.value}},"$XqAkbW6tX2")),e=await e,c(),e);l.value.success||(y.value='Markdown parser error: <span style="color:red">'+l.value.msg+"</span>. Program language does not support."),t.value=l.value.data,t.value.title=o.value.title,t.value.author=o.value.createBy,t.value.time=o.value.createTime,t.value.articleid=o.value.articleid,t.value.editable=o.value.editable}return(a,o)=>{const s=B,l=D,C=E,k=L;return R(),V("div",null,[p(s),n("main",Q,[n("div",z,[n("div",J,[n("div",K,h(u(t).title),1),n("div",Y,[n("span",Z,[p(l,{name:"i-heroicons-calendar-days"})]),p(C,{text:"Update time: "+u(w)(u(t).time,"en"),popper:{arrow:!0}},{default:M(()=>[n("span",ee,h(u(w)(u(t).createTime,"en")),1)]),_:1},8,["text"]),n("span",te,h(u(t).author),1),n("span",ae,[n("span",{class:"toolbaritem",style:{padding:"0px","margin-right":"5px"},onClick:$},ne),p(k,{to:"/md/edit?id="+u(t).articleid},{default:M(()=>[p(l,{name:"i-heroicons-pencil-square"}),se]),_:1},8,["to"])])]),n("section",{id:"output",innerHTML:u(_)},null,8,ie)]),ce])])])}}});export{qe as default};
