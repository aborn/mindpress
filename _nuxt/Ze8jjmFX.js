import{_ as N}from"./CUk0g32w.js";import L from"./0u8XdJeX.js";import{_ as T,g as O,h as A,i as E,o as p,j as I,c as h,n as R,k as V,r as _,l as P,m as v,b as f,a as o,t as g,f as r,w as S,F as Q,q as U,s as G}from"./2TuLkrXX.js";import{_ as H}from"./DNA7qtgR.js";import Y from"./CG4i5-o6.js";import{b as j,m as B,a as z}from"./tRb40OuR.js";import{M as $}from"./DshPJGOp.js";import{q as F}from"./BxS9K1Zf.js";import{u as M}from"./BfiQ5vVh.js";import{u as J}from"./CnTtQGPf.js";import"./BQkc-AXV.js";import"./CLIuvmZe.js";import"./C-v3KzvZ.js";import"./DYiDdvK0.js";import"./DvDH6DOc.js";const K=O({props:{name:{type:String,required:!0},dynamic:{type:Boolean,default:!1}},setup(u){const e=A();return{dynamic:E(()=>{var m,t;return u.dynamic||((t=(m=e.ui)==null?void 0:m.icons)==null?void 0:t.dynamic)})}}});function W(u,e,n,m,t,y){const i=L;return u.dynamic?(p(),I(i,{key:0,name:u.name},null,8,["name"])):(p(),h("span",{key:1,class:R(u.name)},null,2))}const X=T(K,[["render",W]]),Z={class:"container"},ee={class:"main-container"},te={class:"content-container"},ae={class:"article-title"},oe={class:"article-meta-container"},ne={class:"article-meta"},se={class:"article-meta"},re={class:"article-meta",style:{"margin-left":"0.3rem"}},ce={class:"article-meta"},ie=o("span",{class:"article-edit"},"Edit",-1),le=["innerHTML"],ue={class:"siderbar-container"},me={key:0},de=["href"],Be={__name:"[...slug]",async setup(u){let e,n;const m=V(),t=_(),y=_(""),i=_(""),D=z,d=j(P().public.minpress),b=m.query,k=m.params.slug,s=(d.mode===$.SSG||d.mode===$.FCM)&&k[0]==="undefined"?_(null):_(k[0]);if(!s.value&&b.id&&(s.value=b.id),console.log("mode===>"+d.mode),d.mode===$.SSG){y.value="No content found.";const c="/article/"+s.value;console.log(c);const a=s.value.indexOf(":")>=0?([e,n]=v(()=>F().where({_id:{$eq:s.value}}).findOne()),e=await e,n(),e):([e,n]=v(()=>F().where({permalink:{$eq:c}}).findOne()),e=await e,n(),e);console.log(a),t.value=a,t.value.time=a.date,t.value.author=B(a),t.value.articleid=s.value,i.value=a.body.toc}else if(d.mode==$.FCM)try{const{data:c}=([e,n]=v(()=>M("/api/md/query?_id="+s.value,"$1QhhxcnDTY")),e=await e,n(),e);console.log("***************");const a=c.value;console.log(a),t.value=a,t.value.time=a.date,t.value.author=B(a),t.value.articleid=s.value,i.value=a.body.toc}catch(c){console.warn(c)}else{console.log("server mode.");const c=d.contentUrl+"/"+s.value,{data:a}=([e,n]=v(()=>M(c,"$3maICFseYQ")),e=await e,n(),e),C=_(a.value.content),{data:l,refresh:x}=([e,n]=v(async()=>J(s.value,async()=>{try{return await $fetch("/api/parse",{method:"POST",cors:!0,body:{id:"content:_file.md",content:C.value}})}catch{return l.value}},"$aBbtUaneJv")),e=await e,n(),e);l.value.success||(y.value='Markdown parser error: <span style="color:red">'+l.value.msg+"</span>. Program language does not support."),t.value=l.value.data,t.value.title=a.value.title,t.value.author=a.value.createBy,t.value.time=a.value.createTime,t.value.articleid=a.value.articleid,t.value.editable=a.value.editable}return(c,a)=>{const C=N,l=X,x=H,q=Y;return p(),h("div",null,[f(C),o("main",Z,[o("div",ee,[o("div",te,[o("div",ae,g(r(t).title),1),o("div",oe,[o("span",ne,[f(l,{name:"i-heroicons-calendar-days"})]),o("span",se,g(r(D)(r(t).createTime,"en")),1),o("span",re,g(r(t).author),1),o("span",ce,[f(x,{to:"/edit?id="+r(t).articleid},{default:S(()=>[f(l,{name:"i-heroicons-pencil-square"}),ie]),_:1},8,["to"])])]),f(q,{value:r(t)},{empty:S(()=>[o("label",{style:{"margin-bottom":"1rem"},innerHTML:r(y)},null,8,le)]),_:1},8,["value"])]),o("div",ue,[r(i)&&r(i).links?(p(),h("ul",me,[(p(!0),h(Q,null,U(r(i).links,w=>(p(),h("li",{key:w.text},[o("a",{href:`#${w.id}`},g(w.text),9,de)]))),128))])):G("",!0)])])])])}}};export{Be as default};
