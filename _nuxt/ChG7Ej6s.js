import{_ as S}from"./CRj8ahT9.js";import $ from"./Dukjs56_.js";import B from"./BeSdypdJ.js";import{_ as U}from"./CVgR94aR.js";import{x as D,g as E,r,h as N,B as O,i as d,j as F,m as I,o as j,c as V,b as p,a as n,t as h,f as u,w as q}from"./BwgUDEiY.js";import{b as W,m as M,a as H}from"./DtlU0Yam.js";import{u as P}from"./IS9YO777.js";import{M as v}from"./DshPJGOp.js";import{q as A}from"./CiT_pmt_.js";import{c as G}from"./CBNSl5vn.js";import{w as R,c as X,a as Q}from"./BpmeChGP.js";import"./D_bujDBN.js";import"./B5yWAgY5.js";import"./l9Fjg48g.js";import"./CtDIjDjQ.js";import"./D2mGxeGQ.js";import"./D04ntHsw.js";import"./BosuxZz1.js";const z={class:"container"},J={class:"main-container"},K={class:"content-container"},Y={class:"article-title"},Z={class:"article-meta-container"},ee={class:"article-meta"},te={class:"article-meta"},oe={class:"article-meta",style:{"margin-left":"0.3rem"}},ae={class:"article-meta"},ne=n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"24",viewBox:"0 0 24 24"},[n("path",{fill:"currentColor",d:"M15.85 8.14c.39 0 .77.03 1.14.08C16.31 5.25 13.19 3 9.44 3c-4.25 0-7.7 2.88-7.7 6.43c0 2.05 1.15 3.86 2.94 5.04L3.67 16.5l2.76-1.19c.59.21 1.21.38 1.87.47c-.09-.39-.14-.79-.14-1.21c-.01-3.54 3.44-6.43 7.69-6.43M12 5.89a.96.96 0 1 1 0 1.92a.96.96 0 0 1 0-1.92M6.87 7.82a.96.96 0 1 1 0-1.92a.96.96 0 0 1 0 1.92"}),n("path",{fill:"currentColor",d:"M22.26 14.57c0-2.84-2.87-5.14-6.41-5.14s-6.41 2.3-6.41 5.14s2.87 5.14 6.41 5.14c.58 0 1.14-.08 1.67-.2L20.98 21l-1.2-2.4c1.5-.94 2.48-2.38 2.48-4.03m-8.34-.32a.96.96 0 1 1 .96-.96c.01.53-.43.96-.96.96m3.85 0a.96.96 0 1 1 0-1.92a.96.96 0 0 1 0 1.92"})],-1),se=[ne],ie=n("span",{class:"article-edit"},"Edit",-1),ce=["innerHTML"],le=n("div",{id:"snackbar"},null,-1),Te=D({__name:"[...slug]",async setup(re){let e,c;const f=E(),t=r(),y=r(""),_=r(""),g=r(""),w=H,m=W(N().public.mindpress),b=f.query;let T=r("");P().hostname;const x=f.params.slug,i=(m.mode===v.SSG||m.mode===v.FCM)&&x[0]==="undefined"?r(null):r(x[0]);!i.value&&b.id&&(i.value=b.id),O(()=>{{let o=X.codeThemeOption[2].value,a=document.getElementById("hljs");if(a!=null)a.setAttribute("href",o);else{const s=document.createElement("link");s.setAttribute("type","text/css"),s.setAttribute("rel","stylesheet"),s.setAttribute("href",o),s.setAttribute("id","hljs"),document.head.appendChild(s)}}});function L(){Q(_.value)}if(console.log("mode===>"+m.mode+",  articleid.value="+i.value),m.mode===v.SSG){y.value="No content found.";const o="/article/"+i.value;console.log(o);const a=i.value.indexOf(":")>=0?([e,c]=d(()=>A().where({_id:{$eq:i.value}}).findOne()),e=await e,c(),e):([e,c]=d(()=>A().where({permalink:{$eq:o}}).findOne()),e=await e,c(),e);console.log(a),t.value=a,t.value.time=a.date,t.value.author=M(a),t.value.articleid=i.value,g.value=a.body.toc;const s=G(a.body),l=R(s);_.value=l}else if(m.mode==v.FCM)try{const o=([e,c]=d(()=>$fetch("/api/md/queryContent?_id="+i.value)),e=await e,c(),e);console.log("***************  client api ---"),console.log(o),t.value=o,t.value.time=o.date,t.value.author=M(o),t.value.articleid=i.value,g.value=o.body&&o.body.toc,T.value=o._file;const a=o.mdcontent,s=R(a);_.value=s}catch(o){console.warn(o)}else{console.log("server mode.");const o=m.contentUrl+"/"+i.value,{data:a}=([e,c]=d(()=>F(o,"$qjI33vIWiV")),e=await e,c(),e),s=r(a.value.content),{data:l,refresh:C}=([e,c]=d(async()=>I(i.value,async()=>{try{return await $fetch("/api/parse",{method:"POST",cors:!0,body:{id:"content:_file.md",content:s.value}})}catch{return l.value}},"$XqAkbW6tX2")),e=await e,c(),e);l.value.success||(y.value='Markdown parser error: <span style="color:red">'+l.value.msg+"</span>. Program language does not support."),t.value=l.value.data,t.value.title=a.value.title,t.value.author=a.value.createBy,t.value.time=a.value.createTime,t.value.articleid=a.value.articleid,t.value.editable=a.value.editable}return(o,a)=>{const s=S,l=$,C=B,k=U;return j(),V("div",null,[p(s),n("main",z,[n("div",J,[n("div",K,[n("div",Y,h(u(t).title),1),n("div",Z,[n("span",ee,[p(l,{name:"i-heroicons-calendar-days"})]),p(C,{text:"Update time: "+u(w)(u(t).time,"en"),popper:{arrow:!0}},{default:q(()=>[n("span",te,h(u(w)(u(t).createTime,"en")),1)]),_:1},8,["text"]),n("span",oe,h(u(t).author),1),n("span",ae,[n("span",{class:"toolbaritem",style:{padding:"0px","margin-right":"5px"},onClick:L},se),p(k,{to:"/md/edit?id="+u(t).articleid},{default:q(()=>[p(l,{name:"i-heroicons-pencil-square"}),ie]),_:1},8,["to"])])]),n("section",{id:"output",innerHTML:u(_)},null,8,ce)]),le])])])}}});export{Te as default};
